\subsection{The models}

	For all the datasets a model with the following configuration has been trained. The inputs of the model are the PL intensities and the outputs are the flattened matrices that represent the PSFs' complex fields.\\
	
	{\normalsize HYPERPARAMETERS:}
	\begin{lstlisting}
	*ARCHITECTURE HYPERPARAMETERS:
		-Fully Connected
		-Input shape: 19
		-Output shape: 32768
		-Hidden layers: [1024, 1024, 1024, 1024, 1024, 1024]
		-Regularizer: None
		-Hidden Layers Activation: relu
		-Output Layer Activation: linear
		-Batch Normalization: False
		-Dropout: False, 0.2
	
	*COMPILATION HYPERPARAMETERS:
		-Optimizer: ADAM lr=0.001, beta_1=0.9, beta_2=0.999
		-Loss Function: MSE
		-Metric: MSE
	
	*TRAINING HYPERPARAMETERS:
		-Epochs: 200
		-Batch size: 32
		-Callbacks: 
			-ReduceLROnPlateau: MSE 20 x0.1
			-Early Stop: MSE 50
	\end{lstlisting}
	
	The exception is the model trained for the Atmospheric Aberration Cropped PSF which has Batch Normalization activated.
	
	\subsubsection{Atmospheric aberration related models}
	
		\subparagraph{Original sized PSF}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.004607476759701967
        		-Validation MSE: 0.056021399796009064
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-PSFRecontructorSuperBigFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-PSFRecontructorSuperBigFC70000-1-val.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-PSFRecontructorSuperBigFC70000-1-train.png}}\\
			\caption{Results of training the model PSFRecontructorSuperBigFC70000-1}
		\end{figure*}
		
		\subparagraph{Cropped sized PSF}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.008466990664601326
        		-Validation MSE: 0.20970138907432556
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-CroppedBNFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-CroppedBNFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-CroppedBNFC70000-1-train.png}}\\
			\caption{Results of training the model PSFRecontructorSuperBigFC70000-1}
		\end{figure*}
	
\FloatBarrier
	\subsubsection{Zernike modes related models}
		\subparagraph{Original sized 2 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.00000000895368188480461
        		-Validation MSE: 0.034455109387636185
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike2MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike2MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike2MFC70000-1-train.png}}\\
			\caption{Model training for original sized 2 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Cropped sized 2 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.00000024662290343258064
        		-Validation MSE: 0.13220909237861633
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike2MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike2MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike2MFC70000-1-train.png}}\\
			\caption{Model training for cropped sized 2 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Original sized 5 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.0000018320155277251615
        		-Validation MSE: 0.0000026587338197714416
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike5MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike5MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike5MFC70000-1-train.png}}\\
			\caption{Model training for original sized 5 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Cropped sized 5 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.0000049307855078950524
        		-Validation MSE: 0.00000881233972904738
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike5MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike5MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike5MFC70000-1-train.png}}\\
			\caption{Model training for cropped sized 5 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Original sized 9 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.000016877984307939187
        		-Validation MSE: 0.00010731885413406417
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike9MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike9MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike9MFC70000-1-train.png}}\\
			\caption{Model training for original sized 9 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Cropped sized 9 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.00003678303983178921
        		-Validation MSE: 0.00034940888872370124
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike9MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike9MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike9MFC70000-1-train.png}}\\
			\caption{Model training for cropped sized 9 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Original sized 14 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.00008819704817142338
        		-Validation MSE: 0.002211778424680233
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike14MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike14MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike14MFC70000-1-train.png}}\\
			\caption{Model training for original sized 14 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Cropped sized 14 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.00009449137724004686
        		-Validation MSE: 0.007428955752402544
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike14MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike14MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike14MFC70000-1-train.png}}\\
			\caption{Model training for cropped sized 14 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Original sized 20 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.0002106916217599064
        		-Validation MSE: 0.007495625875890255
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike20MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike20MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigZernike20MFC70000-1-train.png}}\\
			\caption{Model training for original sized 20 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		\subparagraph{Cropped sized 20 modes PSFs}:\\
		\begin{lstlisting}	
        		-Train MSE: 0.001225156243890524
        		-Validation MSE: 0.023689033463597298
		\end{lstlisting}
		
		\begin{figure*}[ht!]
			\subfloat[Training Evolution]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike20MFC70000-1-evolution.png}}
			\hspace{\fill}
			\subfloat[Validation example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike20MFC70000-1-validation.png}}
			\hspace{\fill}
			\subfloat[Train example]{%
			\includegraphics[ width=0.31\textwidth]{psf-SuperBigCroppedZernike20MFC70000-1-train.png}}\\
			\caption{Model training for cropped sized 20 zernike modes PSFs}
		\end{figure*}
		\FloatBarrier
		
		A summary of the MSE evolution over the Zernike PSFs datasets is shown below. The fact that the validation MSE for 2 modes is the worse may be because the neural network is not able to understand traslations.
		\begin{figure*}[ht!]
			\centering
			\includegraphics[width=\textwidth]{pid-mseevolutionzernikedatasets}
			\caption{MSE evolution over the Zernike PSFs datasets}
		\end{figure*}
		
		\FloatBarrier